{"version":3,"file":"secure-storage.cjs.js","sources":["../node_modules/tslib/tslib.es6.js","../src/SecureStorage.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","/**\r\n * Classe permettant de chiffrer et déchiffrer les données stockées dans IndexedDB\r\n * en utilisant l'API Web Crypto.\r\n *\r\n * Cette classe utilise l'algorithme AES-GCM, qui fournit à la fois confidentialité et\r\n * authenticité des données, et génère des clés sécurisées avec PBKDF2.\r\n */\r\nexport class SecureStorage {\r\n  private static readonly SALT_LENGTH = 16;\r\n  private static readonly IV_LENGTH = 12;\r\n  private static readonly KEY_LENGTH = 256; // bits\r\n  private static readonly ITERATIONS = 100000;\r\n  private static readonly ALGO = \"AES-GCM\";\r\n  private static readonly KEY_DERIVATION = \"PBKDF2\";\r\n  private masterKey: CryptoKey | null = null;\r\n  private ready: Promise<void>;\r\n\r\n  /**\r\n   * Initialise le stockage sécurisé avec une clé maître dérivée du mot de passe fourni\r\n   *\r\n   * @param password - Le mot de passe utilisé pour dériver la clé de chiffrement\r\n   * @param salt - Le sel utilisé pour la dérivation de clé (généré si non fourni)\r\n   */\r\n  constructor(password: string, salt?: Uint8Array) {\r\n    this.ready = this.initialize(password, salt);\r\n  }\r\n\r\n  /**\r\n   * Initialise la clé maître en la dérivant du mot de passe\r\n   *\r\n   * @param password - Mot de passe utilisateur\r\n   * @param providedSalt - Sel optionnel (pour consistance entre les sessions)\r\n   * @returns Promise qui se résout quand la clé est prête\r\n   */\r\n  private async initialize(\r\n    password: string,\r\n    providedSalt?: Uint8Array\r\n  ): Promise<void> {\r\n    try {\r\n      // Générer ou utiliser le sel fourni\r\n      const salt =\r\n        providedSalt ||\r\n        crypto.getRandomValues(new Uint8Array(SecureStorage.SALT_LENGTH));\r\n\r\n      // Convertir le mot de passe en données binaires\r\n      const passwordBuffer = new TextEncoder().encode(password);\r\n\r\n      // Dériver une clé à partir du mot de passe avec PBKDF2\r\n      const baseKey = await crypto.subtle.importKey(\r\n        \"raw\",\r\n        passwordBuffer,\r\n        { name: SecureStorage.KEY_DERIVATION },\r\n        false,\r\n        [\"deriveKey\"]\r\n      );\r\n\r\n      // Générer la clé AES-GCM à partir de la clé de base\r\n      this.masterKey = await crypto.subtle.deriveKey(\r\n        {\r\n          name: SecureStorage.KEY_DERIVATION,\r\n          salt,\r\n          iterations: SecureStorage.ITERATIONS,\r\n          hash: \"SHA-256\",\r\n        },\r\n        baseKey,\r\n        {\r\n          name: SecureStorage.ALGO,\r\n          length: SecureStorage.KEY_LENGTH,\r\n        },\r\n        false, // Non extractible pour la sécurité\r\n        [\"encrypt\", \"decrypt\"]\r\n      );\r\n\r\n      // Stocker le sel de manière sécurisée pour une utilisation ultérieure\r\n      // (nécessaire pour déchiffrer les données plus tard avec le même mot de passe)\r\n      await this.saveSecurityParams(salt);\r\n    } catch (error) {\r\n      console.error(\"Erreur lors de l'initialisation du chiffrement:\", error);\r\n      throw new Error(\"Impossible d'initialiser le chiffrement\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sauvegarde les paramètres de sécurité (comme le sel) dans IndexedDB\r\n   *\r\n   * @param salt - Le sel utilisé pour la dérivation de clé\r\n   */\r\n  private async saveSecurityParams(salt: Uint8Array): Promise<void> {\r\n    // Ouvrir une base IndexedDB pour les paramètres de sécurité\r\n    const db = await this.openSecurityDb();\r\n\r\n    const transaction = db.transaction([\"params\"], \"readwrite\");\r\n    const store = transaction.objectStore(\"params\");\r\n\r\n    // Stocker le sel pour une utilisation ultérieure\r\n    await store.put({ id: \"salt\", value: salt });\r\n\r\n    db.close();\r\n  }\r\n\r\n  /**\r\n   * Récupère les paramètres de sécurité sauvegardés\r\n   *\r\n   * @returns Le sel précédemment sauvegardé\r\n   */\r\n  private async getSecurityParams(): Promise<Uint8Array | null> {\r\n    try {\r\n      const db = await this.openSecurityDb();\r\n      const transaction = db.transaction([\"params\"], \"readonly\");\r\n      const store = transaction.objectStore(\"params\");\r\n\r\n      const saltObj = await store.get(\"salt\");\r\n      db.close();\r\n\r\n      return saltObj?.value || null;\r\n    } catch (error) {\r\n      console.error(\r\n        \"Erreur lors de la récupération des paramètres de sécurité:\",\r\n        error\r\n      );\r\n      return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ouvre ou crée la base de données pour stocker les paramètres de sécurité\r\n   */\r\n  private openSecurityDb(): Promise<IDBDatabase> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = window.indexedDB.open(\"SecureStorageParams\", 1);\r\n\r\n      request.onerror = (event) => {\r\n        reject(\r\n          new Error(\"Impossible d'accéder à la base de paramètres de sécurité\")\r\n        );\r\n      };\r\n\r\n      request.onsuccess = (event) => {\r\n        resolve(request.result);\r\n      };\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = request.result;\r\n        // Créer un store pour les paramètres de sécurité\r\n        if (!db.objectStoreNames.contains(\"params\")) {\r\n          db.createObjectStore(\"params\", { keyPath: \"id\" });\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Chiffre des données pour un stockage sécurisé\r\n   *\r\n   * @param data - Les données à chiffrer (peut être de n'importe quel type JSON-sérialisable)\r\n   * @returns Une promesse qui résout avec un objet contenant les données chiffrées et le vecteur d'initialisation\r\n   * @throws Erreur si le chiffrement échoue\r\n   */\r\n  public async encrypt<T>(\r\n    data: T\r\n  ): Promise<{ encryptedData: ArrayBuffer; iv: Uint8Array }> {\r\n    // Attendre que l'initialisation soit terminée\r\n    await this.ready;\r\n\r\n    if (!this.masterKey) {\r\n      throw new Error(\"Clé de chiffrement non initialisée\");\r\n    }\r\n\r\n    try {\r\n      // Convertir les données en format JSON puis en buffer\r\n      const jsonString = JSON.stringify(data);\r\n      const dataBuffer = new TextEncoder().encode(jsonString);\r\n\r\n      // Générer un vecteur d'initialisation unique\r\n      const iv = crypto.getRandomValues(\r\n        new Uint8Array(SecureStorage.IV_LENGTH)\r\n      );\r\n\r\n      // Chiffrer les données\r\n      const encryptedData = await crypto.subtle.encrypt(\r\n        {\r\n          name: SecureStorage.ALGO,\r\n          iv,\r\n        },\r\n        this.masterKey,\r\n        dataBuffer\r\n      );\r\n\r\n      return { encryptedData, iv };\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du chiffrement:\", error);\r\n      throw new Error(\"Échec du chiffrement des données\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Déchiffre des données précédemment chiffrées\r\n   *\r\n   * @param encryptedData - Les données chiffrées à déchiffrer\r\n   * @param iv - Le vecteur d'initialisation utilisé lors du chiffrement\r\n   * @returns Une promesse qui résout avec les données déchiffrées\r\n   * @throws Erreur si le déchiffrement échoue\r\n   */\r\n  public async decrypt<T>(\r\n    encryptedData: ArrayBuffer,\r\n    iv: Uint8Array\r\n  ): Promise<T> {\r\n    // Attendre que l'initialisation soit terminée\r\n    await this.ready;\r\n\r\n    if (!this.masterKey) {\r\n      throw new Error(\"Clé de chiffrement non initialisée\");\r\n    }\r\n\r\n    try {\r\n      // Déchiffrer les données\r\n      const decryptedBuffer = await crypto.subtle.decrypt(\r\n        {\r\n          name: SecureStorage.ALGO,\r\n          iv,\r\n        },\r\n        this.masterKey,\r\n        encryptedData\r\n      );\r\n\r\n      // Convertir le buffer en chaîne JSON puis parser en objet\r\n      const jsonString = new TextDecoder().decode(decryptedBuffer);\r\n      return JSON.parse(jsonString) as T;\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du déchiffrement:\", error);\r\n      throw new Error(\"Échec du déchiffrement des données\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Utilitaire pour enregistrer des données chiffrées dans IndexedDB\r\n   *\r\n   * @param dbName - Nom de la base de données\r\n   * @param storeName - Nom du store d'objets\r\n   * @param key - Clé sous laquelle stocker les données\r\n   * @param data - Données à chiffrer et stocker\r\n   * @returns Promise qui se résout quand les données sont stockées\r\n   */\r\n  public async storeEncrypted<T>(\r\n    dbName: string,\r\n    storeName: string,\r\n    key: IDBValidKey,\r\n    data: T\r\n  ): Promise<void> {\r\n    try {\r\n      // Chiffrer les données\r\n      const { encryptedData, iv } = await this.encrypt(data);\r\n\r\n      // Ouvrir la base de données\r\n      const db = await this.openDatabase(dbName, storeName);\r\n\r\n      // Stocker les données chiffrées et l'IV ensemble\r\n      const transaction = db.transaction([storeName], \"readwrite\");\r\n      const store = transaction.objectStore(storeName);\r\n\r\n      await store.put({\r\n        key,\r\n        encryptedData,\r\n        iv,\r\n        timestamp: new Date().getTime(),\r\n      });\r\n\r\n      db.close();\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du stockage des données chiffrées:\", error);\r\n      throw new Error(\"Impossible de stocker les données chiffrées\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Récupère et déchiffre des données stockées dans IndexedDB\r\n   *\r\n   * @param dbName - Nom de la base de données\r\n   * @param storeName - Nom du store d'objets\r\n   * @param key - Clé des données à récupérer\r\n   * @returns Promise qui résout avec les données déchiffrées, ou null si non trouvées\r\n   */\r\n  public async retrieveDecrypted<T>(\r\n    dbName: string,\r\n    storeName: string,\r\n    key: IDBValidKey\r\n  ): Promise<T | null> {\r\n    try {\r\n      // Ouvrir la base de données\r\n      const db = await this.openDatabase(dbName, storeName);\r\n\r\n      // Récupérer les données\r\n      const transaction = db.transaction([storeName], \"readonly\");\r\n      const store = transaction.objectStore(storeName);\r\n\r\n      const result = await store.get(key);\r\n      db.close();\r\n\r\n      if (!result) {\r\n        return null;\r\n      }\r\n\r\n      // Déchiffrer et retourner les données\r\n      return await this.decrypt<T>(result.encryptedData, result.iv);\r\n    } catch (error) {\r\n      console.error(\"Erreur lors de la récupération des données:\", error);\r\n      throw new Error(\"Impossible de récupérer les données déchiffrées\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ouvre ou crée une base de données IndexedDB\r\n   *\r\n   * @param dbName - Nom de la base de données\r\n   * @param storeName - Nom du store d'objets à créer/utiliser\r\n   * @returns Promise qui résout avec la connexion à la base de données\r\n   */\r\n  private openDatabase(\r\n    dbName: string,\r\n    storeName: string\r\n  ): Promise<IDBDatabase> {\r\n    return new Promise((resolve, reject) => {\r\n      const request = window.indexedDB.open(dbName, 1);\r\n\r\n      request.onerror = () => {\r\n        reject(new Error(`Impossible d'ouvrir la base de données ${dbName}`));\r\n      };\r\n\r\n      request.onsuccess = () => {\r\n        resolve(request.result);\r\n      };\r\n\r\n      request.onupgradeneeded = (event) => {\r\n        const db = request.result;\r\n\r\n        if (!db.objectStoreNames.contains(storeName)) {\r\n          db.createObjectStore(storeName, { keyPath: \"key\" });\r\n        }\r\n      };\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Change le mot de passe utilisé pour le chiffrement\r\n   * Recrypte toutes les données dans la base spécifiée avec la nouvelle clé\r\n   *\r\n   * @param newPassword - Nouveau mot de passe\r\n   * @param dbName - Nom de la base de données contenant les données à recrypter\r\n   * @param storeNames - Noms des stores à recrypter\r\n   * @returns Promise qui se résout quand toutes les données sont recryptées\r\n   */\r\n  public async changePassword(\r\n    newPassword: string,\r\n    dbName: string,\r\n    storeNames: string[]\r\n  ): Promise<void> {\r\n    // Sauvegarder l'ancienne clé\r\n    const oldKey = this.masterKey;\r\n\r\n    if (!oldKey) {\r\n      throw new Error(\"Clé de chiffrement actuelle non initialisée\");\r\n    }\r\n\r\n    try {\r\n      // Pour chaque store, récupérer toutes les données\r\n      for (const storeName of storeNames) {\r\n        const db = await this.openDatabase(dbName, storeName);\r\n        const transaction = db.transaction([storeName], \"readonly\");\r\n        const store = transaction.objectStore(storeName);\r\n\r\n        // Récupérer toutes les entrées\r\n        const allItems = await new Promise<any[]>((resolve, reject) => {\r\n          const request = store.getAll();\r\n          request.onsuccess = () => resolve(request.result);\r\n          request.onerror = () => reject(request.error);\r\n        });\r\n\r\n        db.close();\r\n\r\n        // Initialiser la nouvelle clé\r\n        await this.initialize(newPassword);\r\n\r\n        // Recrypter et sauvegarder chaque entrée\r\n        for (const item of allItems) {\r\n          // Déchiffrer avec l'ancienne clé\r\n          this.masterKey = oldKey;\r\n          const decryptedData = await this.decrypt(item.encryptedData, item.iv);\r\n\r\n          // Chiffrer avec la nouvelle clé et sauvegarder\r\n          await this.storeEncrypted(dbName, storeName, item.key, decryptedData);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Erreur lors du changement de mot de passe:\", error);\r\n      throw new Error(\"Impossible de changer le mot de passe\");\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","x_google_ignoreList":[0]}